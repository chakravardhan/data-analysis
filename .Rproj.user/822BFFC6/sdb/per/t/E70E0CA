{
    "collab_server" : "",
    "contents" : "library(ggplot2)\ndata <- read.csv(\"leaderboard.csv\")\nhead(data)\nmydata<- data[,names(data) %in% \"Total.Score\"]\nplot(mydata, type=\"p\")\nmycluster <- kmeans(mydata,3,nstart = 20)\nmycluster\ntable(mycluster$cluster)\nmycluster$cluster <- as.factor(mycluster$cluster)\nplot(mydata,col=mycluster$cluster,cex=1,pch=1)\n\nused <- c(\"X3123\",\"X3126\",\"X3136\",\"X3137\",\"X3138\",\"X3140\",\"X3141\",\"X3142\",\"X3143\",\"X3144\")\ncoursedata<- data[,names(data) %in% used]\n\nmat <- matrix(nrow=824,ncol=10)\n\nchange = function(x){\n  if(x==\"na\"){\n    x=\"0\";\n  }else{\n    x=x;\n  }\n}\n\nchange1 = function(x,q){\n  if(x==q[1]){\n    x=\"1\";\n  }\n  else if(x==q[2]){\n    x=\"2\";\n  }\n  else if(x==q[3]){\n    x=\"3\";\n  }\n  else{\n    x=x;\n  }\n}\n  \n\n#1\ntemp <- coursedata$X3123\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,1]<-mycluster$cluster\n\n#2\ntemp <-coursedata$X3126\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,2]<-mycluster$cluster\n\n#3\ntemp <-coursedata$X3136\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,3]<-mycluster$cluster\n\n#4\ntemp <-coursedata$X3137\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,4]<-mycluster$cluster\n\n#5\ntemp <-coursedata$X3138\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,5]<-mycluster$cluster\n\n#6\ntemp <-coursedata$X3140\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,6]<-mycluster$cluster\n\n#7\ntemp <-coursedata$X3141\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,7]<-mycluster$cluster\n\n#8\ntemp <-coursedata$X3142\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,8]<-mycluster$cluster\n\n#9\ntemp <-coursedata$X3143\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,9]<-mycluster$cluster\n\n#10\ntemp <-coursedata$X3144\ntemp<-sapply(as.vector(temp),change)\ntemp<-as.integer(temp)\nplot(temp)\nmycluster <- kmeans(temp,3,nstart = 20)\nplot(temp,col=mycluster$cluster,cex=1,pch=1)\nmycluster\na <- as.vector(order(mycluster$centers))\nmycluster$cluster <- sapply(as.vector(mycluster$cluster),change1,q=a)\nmycluster$cluster <- as.factor(mycluster$cluster)\nmat[,10]<-mycluster$cluster\n\n\nx <- c(\"course#1\",\"course#2\",\"course#3\",\"course#4\",\"course#5\",\"course#6\",\"course#7\",\"course#8\",\"course#9\",\"course#10\")\ncolnames(mat) <- x\nmat\nwrite.csv(mat,file=\"new.csv\")\n",
    "created" : 1510571966074.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3367120633",
    "id" : "E70E0CA",
    "lastKnownWriteTime" : 1510383381,
    "last_content_update" : 1510383381,
    "path" : "D:/project/score data/kmeans.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}